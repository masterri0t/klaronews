
<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <title>KlaroNews</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="KlaroNews – kurze und klare Nachrichten. Was heute wirklich wichtig war, in einfachen Worten erklärt." />

  <!-- Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <link rel="icon" href="klaronews.png" type="image/png">

  <!-- Favicon / PWA -->
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
  <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
  <link rel="shortcut icon" href="/favicon.ico" />
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
  <meta name="apple-mobile-web-app-title" content="KlaroNews" />
  <link rel="manifest" href="/site.webmanifest" />

  <style>
    :root {
      --bg: #050505;
      --bg-card: #111111;
      --bg-card-soft: #181818;
      --accent: #f9ff00;
      --text: #ffffff;
      --muted: #a3a3a3;
      --border: #2b2b2b;
      --radius-lg: 18px;
      --radius-md: 12px;
      --shadow-soft: 0 18px 40px rgba(0,0,0,0.45);
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }
    html { scroll-behavior: smooth; }

    body {
      background: radial-gradient(circle at top, #151515 0, #050505 45%, #000 100%);
      color: var(--text);
      font-family: "Inter", system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      line-height: 1.5;
      min-height: 100vh;
    }

    a { color: inherit; text-decoration: none; }
    .page { max-width: 1120px; margin: 0 auto; padding: 20px 16px 48px; }

    header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
      margin-bottom: 26px;
    }

    .logo-wrap { display: inline-flex; align-items: center; gap: 10px; }
    .logo-box {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 14px;
      border-radius: 999px;
      background: #000;
      border: 1px solid #202020;
      box-shadow: 0 0 0 1px rgba(255,255,255,0.02);
    }
    .logo-text-main {
      font-family: "Montserrat", system-ui, sans-serif;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-size: 0.86rem;
    }
    .logo-pill {
      width: 20px;
      height: 20px;
      background: var(--accent);
      border-radius: 6px 6px 6px 0;
      margin-left: 10px;
    }
    .logo-tagline { font-size: 0.78rem; color: var(--muted); }

    nav {
      display: flex;
      align-items: center;
      gap: 16px;
      font-size: 0.9rem;
    }
    .nav-link {
      padding: 6px 10px;
      border-radius: 999px;
      color: var(--muted);
      transition: 0.18s ease;
    }
    .nav-link:hover { color: var(--text); background: rgba(249,255,0,0.06); }
    .nav-link.active { color: #000; background: var(--accent); font-weight: 600; }

    .nav-cta {
      padding: 7px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      color: var(--accent);
      cursor: pointer;
      font-size: 0.78rem;
      background: rgba(0,0,0,0.35);
      transition: 0.18s ease;
    }
    .nav-cta:hover { background: rgba(249,255,0,0.1); border-color: rgba(249,255,0,0.6); }

    .layout {
      display: grid;
      grid-template-columns: minmax(0, 2.2fr) minmax(260px, 1.1fr);
      gap: 20px;
    }
    @media (max-width: 840px) {
      .layout { grid-template-columns: minmax(0, 1fr); }
      header { flex-direction: column; align-items: flex-start; }
      nav { width: 100%; justify-content: space-between; flex-wrap: wrap; }
    }

    .hero-card {
      position: relative;
      padding: 20px 20px 18px;
      border-radius: var(--radius-lg);
      background: linear-gradient(145deg, #151515 0%, #060606 60%, #181818 100%);
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(255,255,255,0.03);
      overflow: hidden;
    }

    .hero-label-row {
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 8px;
      margin-bottom: 16px;
    }

    .badge-live {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 4px 8px;
      border-radius: 999px;
      background: #000;
      color: var(--accent);
      font-size: 0.72rem;
      text-transform: uppercase;
      letter-spacing: 0.1em;
      border: 1px solid rgba(249,255,0,0.6);
    }
    .badge-live-dot {
      width: 7px;
      height: 7px;
      border-radius: 999px;
      background: var(--accent);
      box-shadow: 0 0 0 3px rgba(249,255,0,0.35);
    }

    .hero-meta { font-size: 0.75rem; color: var(--muted); }

    .hero-title {
      font-family: "Montserrat", system-ui, sans-serif;
      font-size: 1.6rem;
      line-height: 1.18;
      margin-bottom: 10px;
    }
    .hero-subtitle { font-size: 0.95rem; color: var(--muted); margin-bottom: 18px; }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .btn-primary {
      padding: 8px 14px;
      border-radius: 999px;
      background: var(--accent);
      color: #000;
      font-size: 0.86rem;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: 0.18s ease;
    }
    .btn-primary:hover {
      filter: brightness(1.05);
      transform: translateY(-1px);
      box-shadow: 0 12px 24px rgba(249,255,0,0.25);
    }
    .btn-primary.btn-error { background: #ff3b3b; color: #ffffff; }

    .btn-ghost {
      padding: 8px 12px;
      border-radius: 999px;
      font-size: 0.82rem;
      border: 1px solid var(--border);
      background: transparent;
      color: var(--muted);
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: 0.18s ease;
    }
    .btn-ghost:hover {
      border-color: rgba(255,255,255,0.3);
      color: var(--text);
      background: rgba(255,255,255,0.02);
    }

    .hero-tags { display: flex; flex-wrap: wrap; gap: 8px; margin-top: 4px; }
    .tag { padding: 4px 9px; border-radius: 999px; border: 1px solid var(--border); font-size: 0.72rem; color: var(--muted); }

    .hero-highlight {
      position: absolute;
      inset: auto -120px -130px auto;
      width: 260px;
      height: 260px;
      background: radial-gradient(circle, rgba(249,255,0,0.22) 0, transparent 65%);
      opacity: 0.9;
      pointer-events: none;
    }

    .section-title {
      font-size: 0.92rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
      margin: 18px 2px 10px;
    }

    .articles-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
      gap: 16px;
    }

    .article-card {
      background: var(--bg-card);
      border-radius: var(--radius-md);
      padding: 14px 14px 12px;
      border: 1px solid var(--border);
      transition: 0.18s ease;
      cursor: pointer;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    .article-card:hover {
      transform: translateY(-2px);
      border-color: rgba(249,255,0,0.45);
      box-shadow: 0 12px 24px rgba(0,0,0,0.55);
    }

    .article-chip-row { display: flex; justify-content: space-between; align-items: center; gap: 8px; }
    .article-chip { font-size: 0.72rem; color: var(--muted); text-transform: uppercase; letter-spacing: 0.11em; }
    .article-time { font-size: 0.7rem; color: var(--muted); }
    .article-title { font-size: 0.98rem; font-weight: 600; }
    .article-desc { font-size: 0.83rem; color: var(--muted); }

    .sidebar-card {
      background: var(--bg-card-soft);
      border-radius: var(--radius-lg);
      padding: 16px 16px 14px;
      border: 1px solid var(--border);
      box-shadow: 0 14px 30px rgba(0,0,0,0.55);
    }
    .sidebar-title {
      font-size: 0.9rem;
      text-transform: uppercase;
      letter-spacing: 0.16em;
      color: var(--muted);
      margin-bottom: 10px;
    }
    .sidebar-list { list-style: none; }
    .sidebar-item { padding: 9px 0; border-bottom: 1px dashed #292929; }
    .sidebar-item:last-child { border-bottom: none; }

    .sidebar-link { display: block; cursor: pointer; }
    .sidebar-link-title { font-size: 0.86rem; }
    .sidebar-link-sub { font-size: 0.74rem; color: var(--muted); }
    .sidebar-item:hover .sidebar-link-title { text-decoration: underline; }

    .newsletter { margin-top: 18px; padding-top: 12px; border-top: 1px solid #292929; }
    .newsletter p { font-size: 0.84rem; color: var(--muted); margin-bottom: 10px; }
    .newsletter-form { display: flex; flex-wrap: wrap; gap: 8px; }
    .newsletter-input {
      flex: 1 1 140px;
      padding: 8px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #050505;
      color: var(--text);
      font-size: 0.82rem;
      outline: none;
    }
    .newsletter-input::placeholder { color: #555; }
    .newsletter-button {
      padding: 8px 13px;
      border-radius: 999px;
      border: none;
      background: var(--accent);
      color: #000;
      font-size: 0.82rem;
      font-weight: 600;
      cursor: pointer;
      white-space: nowrap;
      transition: 0.18s ease;
    }
    .newsletter-button:hover { filter: brightness(1.05); }

    @media (max-width: 900px) {
      .page { padding: 16px 12px 32px; }
      header { flex-direction: column; align-items: flex-start; gap: 10px; }
      nav { width: 100%; justify-content: flex-start; flex-wrap: wrap; gap: 8px; }
      .nav-link, .nav-cta { font-size: 0.82rem; padding: 6px 10px; }
      .layout { grid-template-columns: 1fr; gap: 18px; }
      .hero-card { padding: 16px 14px 16px; }
      .hero-title { font-size: 1.35rem; }
      .hero-subtitle { font-size: 0.9rem; }
      .articles-grid { grid-template-columns: minmax(0, 1fr); }
      .sidebar-card { margin-top: 6px; }
    }

    @media (max-width: 600px) {
      .logo-box { padding: 7px 12px; }
      .logo-text-main { font-size: 0.78rem; }
      .logo-tagline { font-size: 0.7rem; }
      nav { gap: 6px; }
      .nav-link, .nav-cta { padding: 5px 9px; font-size: 0.78rem; }
      .hero-label-row { flex-direction: column; align-items: flex-start; gap: 6px; }
      .hero-title { font-size: 1.25rem; }
      .hero-subtitle { font-size: 0.86rem; }
      .hero-actions { flex-direction: column; align-items: stretch; }
      .btn-primary, .btn-ghost { width: 100%; justify-content: center; }
      footer { flex-direction: column; align-items: flex-start; gap: 8px; }
    }

    footer {
      margin-top: 32px;
      padding-top: 18px;
      border-top: 1px solid #181818;
      font-size: 0.76rem;
      color: var(--muted);
      display: flex;
      flex-wrap: wrap;
      gap: 6px 18px;
      justify-content: space-between;
      align-items: center;
    }
    .footer-links { display: flex; gap: 12px; flex-wrap: wrap; }
    .footer-links a { color: var(--muted); }
    .footer-links a:hover { color: var(--text); }

    /* Datenschutz-Overlay */
    #ds-overlay {
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.65);
      backdrop-filter: blur(4px);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 99999;
      padding: 20px;
    }
    #ds-box {
      background: #111;
      color: white;
      width: 90%;
      max-width: 900px;
      max-height: 90vh;
      border-radius: 16px;
      padding: 20px;
      overflow: hidden;
      border: 1px solid #2b2b2b;
      box-shadow: 0 18px 40px rgba(0,0,0,0.5);
    }
    #ds-box h2 { font-size: 1.4rem; margin-bottom: 12px; }
    #ds-content {
      background: #181818;
      border-radius: 12px;
      border: 1px solid #2b2b2b;
      padding: 14px;
      height: 60vh;
      overflow-y: auto;
    }
    .ds-buttons { display: flex; flex-direction: column; gap: 8px; margin-top: 16px; }
    #ds-accept {
      width: 100%;
      padding: 12px;
      background: #555;
      color: #aaa;
      border-radius: 999px;
      font-size: 1rem;
      border: none;
      cursor: not-allowed;
      transition: 0.25s;
    }
    #ds-accept.active { background: #f9ff00; color: #000; cursor: pointer; }
    #ds-skip {
      width: 100%;
      padding: 10px;
      border-radius: 999px;
      font-size: 0.9rem;
      border: 1px solid #2b2b2b;
      background: transparent;
      color: #ddd;
      cursor: pointer;
      transition: 0.25s;
    }
    #ds-skip:hover { background: rgba(255,255,255,0.04); border-color: rgba(255,255,255,0.4); }

    /* Artikel-Viewer (Modal) */
   /* Artikel Reader (Full-Page wie Screenshot 2) */
#article-modal{
  position: fixed;
  inset: 0;
  display: none;
  z-index: 99998;
  background: radial-gradient(circle at top, #151515 0, #050505 45%, #000 100%);
  overflow: auto;
  padding: 22px 16px 26px;
}

.reader-shell{
  max-width: 1180px;
  margin: 0 auto;
  min-height: calc(100vh - 48px);
  display: flex;
  flex-direction: column;
  gap: 18px;
}

.reader-topbar{
  display:flex;
  align-items:flex-start;
  justify-content:space-between;
  gap: 14px;
  padding: 2px 2px 0;
}

.reader-brand .logo-tagline{
  margin-top: 6px;
  font-size: 0.8rem;
  color: var(--muted);
}

.reader-nav{
  display:flex;
  align-items:center;
  gap: 16px;
  flex-wrap: wrap;
  justify-content:flex-end;
  padding-top: 4px;
}

.reader-card{
  width: 100%;
  border-radius: 22px;
  border: 1px solid rgba(255,255,255,0.06);
  background: linear-gradient(180deg, rgba(18,18,18,0.9) 0%, rgba(10,10,10,0.92) 100%);
  box-shadow: 0 22px 70px rgba(0,0,0,0.65);
  padding: 22px 22px 18px;
}

.reader-head{
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap: 10px;
  margin-bottom: 10px;
}

.reader-chip{
  display:inline-flex;
  align-items:center;
  gap: 8px;
  padding: 7px 14px;
  border-radius: 999px;
  border: 1px solid rgba(249,255,0,0.45);
  background: rgba(0,0,0,0.35);
  color: var(--accent);
  font-size: 0.78rem;
  text-transform: uppercase;
  letter-spacing: 0.12em;
  font-weight: 800;
}

.reader-stand{
  color: var(--muted);
  font-size: 0.9rem;
}

.reader-title{
  font-family: "Montserrat", system-ui, sans-serif;
  font-size: 2.2rem;
  line-height: 1.12;
  margin: 8px 0 10px;
}

.reader-sub{
  color: #cfcfcf;
  font-size: 1.05rem;
  margin-bottom: 16px;
}

.reader-content{
  color: #eaeaea;
  font-size: 1rem;
  line-height: 1.65;
}

.reader-content p{ margin: 0 0 12px; }
.reader-content ul{ margin: 0 0 12px 18px; }
.reader-content li{ margin-bottom: 6px; }
.reader-content .note{
  border: 1px solid rgba(249,255,0,0.22);
  background: rgba(249,255,0,0.06);
  border-radius: 16px;
  padding: 12px 12px;
  margin-top: 14px;
  color: #f3f3f3;
}

.reader-back{
  margin-top: 18px;
  padding: 10px 14px;
  border-radius: 999px;
  border: 1px solid var(--border);
  background: rgba(0,0,0,0.25);
  color: var(--text);
  cursor: pointer;
  transition: 0.18s ease;
  display:inline-flex;
  align-items:center;
  gap: 8px;
  width: fit-content;
}
.reader-back:hover{
  border-color: rgba(255,255,255,0.35);
  background: rgba(255,255,255,0.03);
}

.reader-footer{
  margin-top: auto;
  padding: 10px 2px 0;
  color: var(--muted);
  font-size: 0.85rem;
  display:flex;
  justify-content:space-between;
  align-items:center;
  gap: 10px;
  border-top: 1px solid rgba(255,255,255,0.06);
}

@media (max-width: 860px){
  .reader-topbar{ flex-direction: column; align-items:flex-start; }
  .reader-nav{ justify-content:flex-start; }
  .reader-title{ font-size: 1.7rem; }
  .reader-card{ padding: 18px 16px 16px; }
}

    #article-modal .modal-box {
      width: min(980px, 96vw);
      max-height: 92vh;
      overflow: hidden;
      border-radius: 18px;
      border: 1px solid rgba(255,255,255,0.08);
      background: linear-gradient(180deg, #101010 0%, #070707 100%);
      box-shadow: 0 28px 70px rgba(0,0,0,0.65);
      position: relative;
    }
    #article-modal .modal-top {
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      border-bottom: 1px solid rgba(255,255,255,0.06);
      background: rgba(0,0,0,0.35);
    }
    .modal-chip {
      font-size: 0.72rem;
      color: #000;
      background: var(--accent);
      border-radius: 999px;
      padding: 4px 10px;
      font-weight: 700;
      letter-spacing: 0.08em;
      text-transform: uppercase;
    }
    .modal-meta { font-size: 0.78rem; color: var(--muted); }
    .modal-close {
      border: 1px solid var(--border);
      background: transparent;
      color: var(--text);
      border-radius: 999px;
      padding: 8px 10px;
      cursor: pointer;
      transition: 0.18s ease;
      font-size: 0.82rem;
    }
    .modal-close:hover { border-color: rgba(255,255,255,0.35); background: rgba(255,255,255,0.03); }

    #article-modal .modal-body {
      padding: 18px 18px 22px;
      overflow-y: auto;
      max-height: calc(92vh - 58px);
    }
    #article-modal h1 {
      font-family: "Montserrat", system-ui, sans-serif;
      font-size: 1.55rem;
      line-height: 1.18;
      margin-bottom: 10px;
    }
    #article-modal .lead {
      color: var(--muted);
      font-size: 0.98rem;
      margin-bottom: 16px;
    }
    #article-modal .content p { margin: 0 0 12px; color: #eaeaea; }
    #article-modal .content ul { margin: 0 0 12px 18px; color: #eaeaea; }
    #article-modal .content li { margin-bottom: 6px; }
    #article-modal .content .note {
      border: 1px solid rgba(249,255,0,0.28);
      background: rgba(249,255,0,0.06);
      border-radius: 14px;
      padding: 12px 12px;
      margin: 14px 0 0;
      color: #f3f3f3;
    }

    /* Neutraler Empty-State (ohne Erklärung) */
    .empty-card {
      background: rgba(255,255,255,0.02);
      border: 1px dashed #2b2b2b;
      border-radius: var(--radius-md);
      padding: 16px;
      color: var(--muted);
    }
  </style>
   <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-2226170695110634"
    crossorigin="anonymous"></script>
</head>

<body id="top">

  <!-- Datenschutz-Overlay -->
  <div id="ds-overlay">
    <div id="ds-box">
      <h2>Datenschutzerklärung</h2>
      <div id="ds-content"><p>Wird geladen...</p></div>
      <div class="ds-buttons">
        <button id="ds-accept" disabled>Bis zum Ende scrollen…</button>
        <button id="ds-skip" type="button">Weiter ohne Auswahl</button>
      </div>
    </div>
  </div>

  <!-- Artikel Modal -->
  <!-- Artikel Reader (Full-Page wie Screenshot 2) -->
<div id="article-modal" aria-hidden="true">
  <div class="reader-shell" role="dialog" aria-modal="true" aria-label="Artikel">
    <div class="reader-topbar">
      <div class="reader-brand">
        <div class="logo-box">
          <span class="logo-text-main">KLARONEWS</span>
          <span class="logo-pill"></span>
        </div>
        <div class="logo-tagline">News, kurz &amp; klar – ohne Bullshit.</div>
      </div>

      <nav class="reader-nav">
        <a class="nav-link" href="#top">Heute</a>
        <a class="nav-link" href="#politik">Politik</a>
        <a class="nav-link" href="#welt">Welt</a>
        <a class="nav-link" href="#gesellschaft">Gesellschaft</a>
        <a class="nav-cta" href="#newsletter">Newsletter</a>
      </nav>
    </div>

    <article class="reader-card">
      <div class="reader-head">
        <span class="reader-chip" id="modal-category">POLITIK</span>
        <span class="reader-stand">Stand: <span id="modal-stand">—</span></span>
      </div>

      <h1 class="reader-title" id="modal-title">—</h1>
      <p class="reader-sub" id="modal-summary">—</p>

      <div class="reader-content" id="modal-content"></div>

      <button class="reader-back" id="modal-back" type="button">← Zurück</button>
    </article>

    <div class="reader-footer">
      <span>© <span id="reader-year"></span> KlaroNews</span>
      <span>Kurz &amp; klar – für deinen Alltag.</span>
    </div>
  </div>
</div>


  <div class="page">
    <header>
      <div class="logo-wrap">
        <div>
          <div class="logo-box">
            <span class="logo-text-main">KLARONEWS</span>
            <span class="logo-pill"></span>
          </div>
          <div class="logo-tagline">News, kurz & klar</div>
        </div>
      </div>

      <nav>
        <a class="nav-link active" href="#top">Heute</a>
        <a class="nav-link" href="#politik">Politik</a>
        <a class="nav-link" href="#welt">Welt</a>
        <a class="nav-link" href="#gesellschaft">Gesellschaft</a>
        <a class="nav-cta" href="#newsletter">Newsletter</a>
      </nav>
    </header>

    <main class="layout">
      <section>
        <article class="hero-card">
          <div class="hero-label-row">
            <div class="badge-live">
              <span class="badge-live-dot"></span>
              <span>Daily Briefing</span>
            </div>
            <div class="hero-meta">
              Stand: <span id="today-label">heute</span> · <span>in 60 Sekunden erklärt</span>
            </div>
          </div>

          <h1 class="hero-title">Was du heute wirklich wissen musst.</h1>
          <p class="hero-subtitle">
            KlaroNews fasst den Tag für dich zusammen. Nur das, was für dein Leben relevant ist.
          </p>

          <div class="hero-actions">
            <button class="btn-primary" type="button" id="btn-summary">Heutige Zusammenfassung ansehen</button>
            <button class="btn-ghost" type="button" id="btn-last-update">▶ Letztes 60-Sekunden-Update</button>
          </div>

          <div class="hero-tags">
            <span class="tag">Politik &amp; Weltlage</span>
            <span class="tag">Einfach erklärt</span>
            <span class="tag">Für Gen&nbsp;Z &amp; junge Erwachsene</span>
          </div>

          <div class="hero-highlight"></div>
        </article>

        <h2 id="politik" class="section-title">Aktuelle Themen</h2>

        <section class="articles-grid" id="articles-grid">
          <div class="empty-card" id="empty-state" style="display:none;">
            Keine Artikel verfügbar.
          </div>
        </section>
      </section>

      <aside>
        <section class="sidebar-card">
          <h2 class="sidebar-title">Kurz & wichtig</h2>
          <ul class="sidebar-list" id="sidebar-latest"></ul>

          <div class="newsletter" id="newsletter">
            <h3 class="sidebar-title">Newsletter (bald)</h3>
            <p>
              Bald kannst du hier das tägliche <strong>„Klaro Briefing“</strong> per Mail abonnieren. Feature ist noch im Aufbau.
            </p>

            <form class="newsletter-form" onsubmit="event.preventDefault(); alert('Newsletter kommt später. Aktuell noch nicht aktiv.');">
              <input class="newsletter-input" type="email" placeholder="Deine E-Mail-Adresse (noch nicht aktiv)" />
              <button class="newsletter-button" type="submit">Noch nicht verfügbar</button>
            </form>
          </div>
        </section>
      </aside>
    </main>

    <footer>
      <span>© <span id="year"></span> KlaroNews. Alle Rechte vorbehalten.</span>
      <div class="footer-links">
<a href="/main/impressum/">Impressum</a>
<a href="/main/datenschutz/">Datenschutz</a>
<a href="/main/kontakt/">Kontakt</a>


      </div>
    </footer>
  </div>

<script>
document.addEventListener("DOMContentLoaded", () => {
  // ================== HELPERS ==================
  const pad2 = (n) => String(n).padStart(2, "0");
  const startOfDay = (d) => new Date(d.getFullYear(), d.getMonth(), d.getDate(), 0, 0, 0, 0);
  const fmtDate = (d) => `${pad2(d.getDate())}.${pad2(d.getMonth() + 1)}.${d.getFullYear()}`;

  function relTime(iso) {
    const published = new Date(iso);
    const now = new Date();
    const diffMs = now - published;
    const diffMin = Math.floor(diffMs / 1000 / 60);
    const diffHours = Math.floor(diffMin / 60);
    const diffDays = Math.floor(diffHours / 24);

    if (diffMin < 1) return "gerade eben";
    if (diffMin < 60) return `vor ${diffMin} Min`;
    if (diffHours < 24) return `vor ${diffHours} Std`;
    if (diffDays === 1) return "gestern";
    return `${diffDays} Tage alt`;
  }

  function flashBtnError(btn, msg) {
    if (!btn) return;
    const original = btn.textContent;
    btn.classList.add("btn-error");
    btn.textContent = msg;
    setTimeout(() => {
      btn.classList.remove("btn-error");
      btn.textContent = original;
    }, 1200);
  }

  function cleanTitle(t = "") {
    return String(t)
      .replace(/\bKlartext-Update\s*#\d+\b/gi, "")
      .replace(/\s*#\d+\b/g, "")
      .replace(/\s{2,}/g, " ")
      .replace(/\s+–\s+/g, " – ")
      .replace(/\s+:\s+/g, ": ")
      .trim();
  }

  function stripMarkdown(md = "") {
    return String(md)
      .replace(/\r\n/g, "\n")
      .replace(/^\s*#{1,6}\s+/gm, "")
      .replace(/\*\*(.*?)\*\*/g, "$1")
      .replace(/^\s*[-*+]\s+/gm, "")
      .replace(/`{1,3}([^`]+)`{1,3}/g, "$1")
      .replace(/\n{3,}/g, "\n\n")
      .trim();
  }

  function escapeHtml(s) {
    return String(s)
      .replaceAll("&", "&amp;")
      .replaceAll("<", "&lt;")
      .replaceAll(">", "&gt;")
      .replaceAll('"', "&quot;")
      .replaceAll("'", "&#039;");
  }

  // (Reader) bodyHtml kommt schon aus published.json -> wir trusten nur unser eigenes File.
  // Trotzdem: keine Scripts reinrendern (schneller Schutz).
  function safeHtml(html) {
    const s = String(html || "");
    return s.replace(/<script[\s\S]*?>[\s\S]*?<\/script>/gi, "");
  }

  // ================== STATIC PAGES (Sidebar) ==================
  const IMPORTANT_PAGES = [
    { title: "3 Dinge, die du heute wissen musst.", sub: "Daily Klaro Briefing", href: "artikel-3-dinge.html" },
    { title: "FAQ: Wie wir News auswählen & prüfen.", sub: "Transparenz & Quellen", href: "artikel-faq-news.html" },
    { title: "Werde Teil der ersten KlaroNews-Community.", sub: "Feedback, Themenwünsche, Ideen", href: "artikel-community.html" },
  ];

  // ================== UI REFS ==================
  const grid = document.getElementById("articles-grid");
  const emptyState = document.getElementById("empty-state");
  const sidebarLatest = document.getElementById("sidebar-latest");

  // Reader refs
  const modal = document.getElementById("article-modal");
  const modalCategory = document.getElementById("modal-category");
  const modalStand = document.getElementById("modal-stand");
  const modalTitle = document.getElementById("modal-title");
  const modalSummary = document.getElementById("modal-summary");
  const modalContent = document.getElementById("modal-content");
  const modalBack = document.getElementById("modal-back");
  const readerYear = document.getElementById("reader-year");

  // Buttons
  const lastUpdateBtn = document.getElementById("btn-last-update");
  const summaryBtn = document.getElementById("btn-summary");

  // Footer
  const y = document.getElementById("year");
  if (y) y.textContent = String(new Date().getFullYear());
  const t = document.getElementById("today-label");
  if (t) t.textContent = fmtDate(new Date());

  // ================== DATA LOADER (SERVER) ==================
  async function loadPublished() {
    // cache: "no-store" verhindert alte Versionen (trotzdem kann CDN cachen, aber besser)
    const res = await fetch("/main/data/published.json", { cache: "no-store" });
    if (!res.ok) throw new Error("published.json konnte nicht geladen werden");
    const data = await res.json();

    const items = Array.isArray(data.items) ? data.items : [];
    // normalize
    return items
      .filter(a => a && a.id && a.publishedAt)
      .map(a => ({
        id: String(a.id),
        category: a.category || "News",
        title: cleanTitle(a.title || ""),
        summary: stripMarkdown(a.summary || ""),
        bodyHtml: safeHtml(a.bodyHtml || ""),
        publishedAt: a.publishedAt
      }));
  }

  // ================== RENDER ==================
  function renderSidebar(publishedSorted) {
    if (!sidebarLatest) return;
    sidebarLatest.innerHTML = "";

    // Static pages
    IMPORTANT_PAGES.forEach(p => {
      const li = document.createElement("li");
      li.className = "sidebar-item";
      li.innerHTML = `
        <a class="sidebar-link" href="${escapeHtml(p.href)}">
          <div class="sidebar-link-title">${escapeHtml(p.title)}</div>
          <div class="sidebar-link-sub">${escapeHtml(p.sub || "")}</div>
        </a>
      `;
      sidebarLatest.appendChild(li);
    });

    // Latest articles
    if (publishedSorted.length) {
      const liSep = document.createElement("li");
      liSep.className = "sidebar-item";
      liSep.innerHTML = `<div class="sidebar-link-sub">Neueste Artikel</div>`;
      sidebarLatest.appendChild(liSep);

      publishedSorted.slice(0, 3).forEach(a => {
        const li = document.createElement("li");
        li.className = "sidebar-item";
        li.innerHTML = `
          <div class="sidebar-link" data-id="${escapeHtml(a.id)}" role="button" tabindex="0">
            <div class="sidebar-link-title">${escapeHtml(a.title)}</div>
            <div class="sidebar-link-sub">${escapeHtml(a.category)} · ${relTime(a.publishedAt)}</div>
          </div>
        `;
        const el = li.querySelector(".sidebar-link");
        el.addEventListener("click", () => openArticle(a.id, publishedSorted));
        el.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") openArticle(a.id, publishedSorted);
        });
        sidebarLatest.appendChild(li);
      });
    }
  }

  function render(published) {
    const publishedSorted = (published || [])
      .slice()
      .sort((a, b) => new Date(b.publishedAt) - new Date(a.publishedAt));

    renderSidebar(publishedSorted);

    if (!grid || !emptyState) return;

    grid.innerHTML = "";

    if (publishedSorted.length === 0) {
      emptyState.style.display = "block";
      grid.appendChild(emptyState);
      return;
    }

    emptyState.style.display = "none";
    const frag = document.createDocumentFragment();

    publishedSorted.forEach(a => {
      const card = document.createElement("a");
      card.href = `#article=${encodeURIComponent(a.id)}`;
      card.className = "article-card";
      card.setAttribute("data-id", a.id);
      card.setAttribute("data-time", a.publishedAt);

      card.innerHTML = `
        <div class="article-chip-row">
          <span class="article-chip">${escapeHtml(a.category)}</span>
          <span class="article-time">${relTime(a.publishedAt)}</span>
        </div>
        <h3 class="article-title">${escapeHtml(a.title)}</h3>
        <p class="article-desc">${escapeHtml(a.summary)}</p>
      `;

      card.addEventListener("click", (e) => {
        e.preventDefault();
        openArticle(a.id, publishedSorted);
      });

      frag.appendChild(card);
    });

    grid.appendChild(frag);
  }

  // ================== READER ==================
  function openArticle(id, publishedSorted) {
    const a = (publishedSorted || []).find(x => x.id === id);
    if (!a || !modal) return;

    if (modalCategory) modalCategory.textContent = (a.category || "NEWS").toUpperCase();
    if (modalStand) modalStand.textContent = fmtDate(new Date(a.publishedAt));
    if (modalTitle) modalTitle.textContent = a.title;
    if (modalSummary) modalSummary.textContent = a.summary;
    if (modalContent) modalContent.innerHTML = a.bodyHtml || "<p>Kein Inhalt verfügbar.</p>";
    if (readerYear) readerYear.textContent = String(new Date().getFullYear());

    modal.style.display = "block";
    modal.setAttribute("aria-hidden", "false");
    document.body.style.overflow = "hidden";
    history.replaceState(null, "", `#article=${encodeURIComponent(id)}`);
    window.scrollTo({ top: 0, behavior: "instant" });
  }

  function closeReader() {
    if (!modal) return;
    modal.style.display = "none";
    modal.setAttribute("aria-hidden", "true");
    document.body.style.overflow = "";
    history.replaceState(null, "", "#top");
  }

  if (modalBack) modalBack.addEventListener("click", closeReader);
  document.addEventListener("keydown", (e) => {
    if (e.key === "Escape" && modal && modal.style.display === "block") closeReader();
  });

  // ================== BUTTONS ==================
  if (lastUpdateBtn) {
    lastUpdateBtn.addEventListener("click", async () => {
      try {
        const published = await loadPublished();
        if (!published.length) return flashBtnError(lastUpdateBtn, "Noch kein Update verfügbar");
        const latest = published.slice().sort((a,b)=>new Date(b.publishedAt)-new Date(a.publishedAt))[0];
        openArticle(latest.id, published);
      } catch {
        flashBtnError(lastUpdateBtn, "Fehler beim Laden");
      }
    });
  }

  if (summaryBtn) {
    summaryBtn.addEventListener("click", () => flashBtnError(summaryBtn, "Noch keine Zusammenfassung verfügbar"));
  }

  // ================== START (LOAD + RENDER) ==================
  let currentPublished = [];

  async function refresh() {
    try {
      currentPublished = await loadPublished();
      render(currentPublished);

      // deep-link
      const hash = window.location.hash || "";
      const m = hash.match(/#article=([^&]+)/);
      if (m && m[1]) {
        const id = decodeURIComponent(m[1]);
        if (currentPublished.some(a => a.id === id)) openArticle(id, currentPublished);
      }
    } catch (e) {
      // fallback: grid leer lassen, sidebar static bleibt
      renderSidebar([]);
      if (grid && emptyState) {
        grid.innerHTML = "";
        emptyState.style.display = "block";
        grid.appendChild(emptyState);
      }
    }
  }

  refresh();
  setInterval(refresh, 60000); // alle 60s neu (wenn publish.yml neue Artikel gepusht hat)

  // ================== DATENSCHUTZ OVERLAY ==================
  // Hinweis: Das bleibt pro Browser gespeichert (das ist korrekt für Consent).
  // Wenn du willst, dass ALLE es sehen "für immer", ist das rechtlich weird und UX-mäßig Müll.
  // Aber technisch: dann entferne localStorage und zeig es immer.
  const overlay = document.getElementById("ds-overlay");
  const content = document.getElementById("ds-content");
  const acceptBtn = document.getElementById("ds-accept");
  const skipBtn = document.getElementById("ds-skip");

  if (overlay && content && acceptBtn && skipBtn) {
    const seen = localStorage.getItem("dsAccepted") === "true";
    if (!seen) {
      overlay.style.display = "flex";

      // WICHTIG: index.html direkt laden, nicht das Verzeichnis
      fetch("/main/datenschutz/index.html", { cache: "no-store" })
        .then(res => res.ok ? res.text() : Promise.reject())
        .then(html => { content.innerHTML = html; })
        .catch(() => { content.innerHTML = "<p>Datenschutz konnte nicht geladen werden.</p>"; });

      function hideOverlay() {
        overlay.style.opacity = 1;
        setTimeout(() => {
          overlay.style.transition = "0.4s";
          overlay.style.opacity = 0;
          setTimeout(() => { overlay.style.display = "none"; }, 400);
        }, 50);
      }

      // Scroll-to-accept
      acceptBtn.disabled = true;
      content.addEventListener("scroll", () => {
        if (content.scrollTop + content.clientHeight >= content.scrollHeight - 15) {
          acceptBtn.classList.add("active");
          acceptBtn.textContent = "Akzeptieren";
          acceptBtn.disabled = false;
        }
      });

      acceptBtn.addEventListener("click", () => {
        localStorage.setItem("dsAccepted", "true");
        hideOverlay();
      });

      skipBtn.addEventListener("click", () => {
        localStorage.setItem("dsAccepted", "true");
        hideOverlay();
      });
    }
  }
});
</script>

<script>
(() => {
  // Ziel-Routen (immer sauber mit Slash am Ende)
  const ROUTES = [
    { key: "datenschutz", target: "/main/datenschutz/" },
    { key: "impressum",  target: "/main/impressum/"  },
    { key: "kontakt",    target: "/main/kontakt/"    },
    { key: "main",       target: "/main/"            }
  ];

  const normalize = (p) => {
    if (!p) return "/";
    p = p.replace(/\/{2,}/g, "/");
    if (p === "/main") return "/main/";
    if (/^\/main\/(datenschutz|impressum|kontakt)$/.test(p)) return p + "/";
    return p;
  };

  const hardFixIfNeeded = () => {
    const current = normalize(window.location.pathname);

    for (const r of ROUTES) {
      const rx = new RegExp("^/main/" + r.key + "(?:/.*)?$", "i");

      if (r.key === "main") {
        if (/^\/main(?:\/index\.html)?\/?$/i.test(current) && current !== r.target) {
          window.location.replace(r.target);
          return true;
        }
      } else {
        if (rx.test(current) && current !== r.target) {
          window.location.replace(r.target);
          return true;
        }
      }
    }

    const lower = current.toLowerCase();
    if (lower.endsWith("datenschutz.html")) { window.location.replace("/main/datenschutz/"); return true; }
    if (lower.endsWith("impressum.html"))  { window.location.replace("/main/impressum/");  return true; }
    if (lower.endsWith("kontakt.html"))    { window.location.replace("/main/kontakt/");    return true; }

    return false;
  };

  if (hardFixIfNeeded()) return;

  document.addEventListener("click", (e) => {
    const a = e.target.closest && e.target.closest("a");
    if (!a) return;

    const href = (a.getAttribute("href") || "").trim();
    if (!href || href.startsWith("http") || href.startsWith("mailto:") || href.startsWith("tel:")) return;

    const h = href.toLowerCase();

    if (h.includes("datenschutz")) { e.preventDefault(); window.location.href = "/main/datenschutz/"; return; }
    if (h.includes("impressum"))  { e.preventDefault(); window.location.href = "/main/impressum/";  return; }
    if (h.includes("kontakt"))    { e.preventDefault(); window.location.href = "/main/kontakt/";    return; }
  }, true);

  window.addEventListener("popstate", hardFixIfNeeded);
})();
</script>




 
</body>
</html>








